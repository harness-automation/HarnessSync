pipeline:
  name: Staging Staging Services
  identifier: Staging_Staging_Services
  template:
    templateRef: nameSpace_onboard
    versionLabel: v1.0
    templateInputs:
      stages:
        - stage:
            identifier: deploy_secret_store
            template:
              templateInputs:
                type: Deployment
                spec:
                  serviceConfig:
                    serviceRef: <+input>
                    serviceDefinition:
                      type: Kubernetes
                      spec:
                        manifests:
                          - manifest:
                              identifier: acc1
                              type: HelmChart
                              spec:
                                store:
                                  type: Http
                                  spec:
                                    connectorRef: <+input>
                                chartName: <+input>
                                chartVersion: <+input>
                  infrastructure:
                    environmentRef: <+input>
                    infrastructureDefinition:
                      type: KubernetesDirect
                      spec:
                        connectorRef: <+input>
                        namespace: <+input>
        - parallel:
            - stage:
                identifier: deploy_confgi_microservice
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceRef: <+input>
                        serviceDefinition:
                          type: Kubernetes
                          spec:
                            manifests:
                              - manifest:
                                  identifier: abc
                                  type: HelmChart
                                  spec:
                                    store:
                                      type: Http
                                      spec:
                                        connectorRef: <+input>
                                    chartName: <+input>
                                    chartVersion: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
            - stage:
                identifier: config_kafka_map
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceRef: <+input>
                        serviceDefinition:
                          type: Kubernetes
                          spec:
                            manifests:
                              - manifest:
                                  identifier: abc
                                  type: HelmChart
                                  spec:
                                    store:
                                      type: Http
                                      spec:
                                        connectorRef: <+input>
                                    chartName: <+input>
                                    chartVersion: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
            - stage:
                identifier: deploy_external_secret
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceRef: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
            - stage:
                identifier: schema_registry
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceDefinition:
                          type: Kubernetes
                          spec:
                            manifests:
                              - manifest:
                                  identifier: c
                                  type: Values
                                  spec:
                                    store:
                                      type: InheritFromManifest
                                      spec:
                                        paths: <+input>
                              - manifest:
                                  identifier: d
                                  type: K8sManifest
                                  spec:
                                    store:
                                      type: Github
                                      spec:
                                        connectorRef: <+input>
                                        paths: <+input>
                                        repoName: <+input>
                                        branch: <+input>
                            artifacts:
                              primary:
                                type: DockerRegistry
                                spec:
                                  connectorRef: <+input>
                                  imagePath: <+input>
                                  tag: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
            - stage:
                identifier: blu_connector
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceRef: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
            - stage:
                identifier: blu_cli
                template:
                  templateInputs:
                    type: Deployment
                    spec:
                      serviceConfig:
                        serviceDefinition:
                          type: Kubernetes
                          spec:
                            manifests:
                              - manifest:
                                  identifier: a
                                  type: Values
                                  spec:
                                    store:
                                      type: InheritFromManifest
                                      spec:
                                        paths: <+input>
                              - manifest:
                                  identifier: b
                                  type: HelmChart
                                  spec:
                                    store:
                                      type: Http
                                      spec:
                                        connectorRef: <+input>
                                    chartName: <+input>
                                    chartVersion: <+input>
                            artifacts:
                              primary:
                                type: Ecr
                                spec:
                                  connectorRef: <+input>
                                  imagePath: <+input>
                                  tag: <+input>
                                  region: <+input>
                      infrastructure:
                        environmentRef: <+input>
                        infrastructureDefinition:
                          type: KubernetesDirect
                          spec:
                            connectorRef: <+input>
                            namespace: <+input>
                    when:
                      condition: <+input>
  tags: {}
  projectIdentifier: BluTest
  orgIdentifier: default
