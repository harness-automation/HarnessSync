template:
  name: nameSpace onboard
  identifier: nameSpace_onboard
  versionLabel: v1.0
  type: Pipeline
  projectIdentifier: BluTest
  orgIdentifier: default
  tags: {}
  spec:
    stages:
      - stage:
          name: deploy secret store
          identifier: deploy_secret_store
          template:
            templateRef: account.Deploy_SecretStore
            versionLabel: v1.0
            templateInputs:
              type: Deployment
              spec:
                serviceConfig:
                  serviceRef: <+input>
                  serviceDefinition:
                    type: Kubernetes
                    spec:
                      manifests:
                        - manifest:
                            identifier: acc1
                            type: HelmChart
                            spec:
                              store:
                                type: Http
                                spec:
                                  connectorRef: <+input>
                              chartName: <+input>
                              chartVersion: <+input>
                infrastructure:
                  environmentRef: <+input>
                  infrastructureDefinition:
                    type: KubernetesDirect
                    spec:
                      connectorRef: <+input>
                      namespace: <+input>
      - parallel:
          - stage:
              name: deploy confgi microservice
              identifier: deploy_confgi_microservice
              template:
                templateRef: account.Deploy_ConfigMap
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceRef: <+input>
                      serviceDefinition:
                        type: Kubernetes
                        spec:
                          manifests:
                            - manifest:
                                identifier: abc
                                type: HelmChart
                                spec:
                                  store:
                                    type: Http
                                    spec:
                                      connectorRef: <+input>
                                  chartName: <+input>
                                  chartVersion: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
          - stage:
              name: config kafka map
              identifier: config_kafka_map
              template:
                templateRef: account.Deploy_ConfigMap
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceRef: <+input>
                      serviceDefinition:
                        type: Kubernetes
                        spec:
                          manifests:
                            - manifest:
                                identifier: abc
                                type: HelmChart
                                spec:
                                  store:
                                    type: Http
                                    spec:
                                      connectorRef: <+input>
                                  chartName: <+input>
                                  chartVersion: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
          - stage:
              name: deploy external secret
              identifier: deploy_external_secret
              template:
                templateRef: account.Deploy_External_Secret
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceRef: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
          - stage:
              name: schema registry
              identifier: schema_registry
              template:
                templateRef: Schema_Registry
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceDefinition:
                        type: Kubernetes
                        spec:
                          manifests:
                            - manifest:
                                identifier: c
                                type: Values
                                spec:
                                  store:
                                    type: InheritFromManifest
                                    spec:
                                      paths: <+input>
                            - manifest:
                                identifier: d
                                type: K8sManifest
                                spec:
                                  store:
                                    type: Github
                                    spec:
                                      connectorRef: <+input>
                                      paths: <+input>
                                      repoName: <+input>
                                      branch: <+input>
                          artifacts:
                            primary:
                              type: DockerRegistry
                              spec:
                                connectorRef: <+input>
                                imagePath: <+input>
                                tag: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
          - stage:
              name: blu connector
              identifier: blu_connector
              template:
                templateRef: Blu_Connector
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceRef: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
          - stage:
              name: blu cli
              identifier: blu_cli
              template:
                templateRef: Blu_CLI
                versionLabel: v1.0
                templateInputs:
                  type: Deployment
                  spec:
                    serviceConfig:
                      serviceDefinition:
                        type: Kubernetes
                        spec:
                          manifests:
                            - manifest:
                                identifier: a
                                type: Values
                                spec:
                                  store:
                                    type: InheritFromManifest
                                    spec:
                                      paths: <+input>
                            - manifest:
                                identifier: b
                                type: HelmChart
                                spec:
                                  store:
                                    type: Http
                                    spec:
                                      connectorRef: <+input>
                                  chartName: <+input>
                                  chartVersion: <+input>
                          artifacts:
                            primary:
                              type: Ecr
                              spec:
                                connectorRef: <+input>
                                imagePath: <+input>
                                tag: <+input>
                                region: <+input>
                    infrastructure:
                      environmentRef: <+input>
                      infrastructureDefinition:
                        type: KubernetesDirect
                        spec:
                          connectorRef: <+input>
                          namespace: <+input>
                  when:
                    condition: <+input>
